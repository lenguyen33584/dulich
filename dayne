<?php
/**
 * Template for single hotel post type: single-khach_san.php
 */

get_header();
$post_id = get_the_ID();
$gia = get_field('gia_tour', $post_id);
$diem = get_field('diem_danh_gia', $post_id);
$so_danh_gia = get_field('so_danh_gia', $post_id);
$tien_ich = get_field('tien_ich', $post_id);
$noi_bat = get_field('noi_bat', $post_id);
?>
<div class = "custom-container" style="max-width:1140px;margin:auto;display:flex;">
<?php if (function_exists('custom_breadcrumb')) {
    custom_breadcrumb();
}?></div>
<div style="max-width:1140px;margin:auto;padding:24px;">
  <!-- Ảnh đại diện -->
  <div style="display:flex;gap:16px;align-items:flex-start;">
    <?php if (has_post_thumbnail()) : ?>
      <div style="flex:1;">
        <?php the_post_thumbnail('full', ['style'=>'width:100%;border-radius:12px;']); ?>
      </div>
    <?php endif; ?>
    <div style="flex:1;display:flex;flex-direction:column;justify-content:flex-start;gap:10px;">
      <h1><?php the_title(); ?></h1>
      <div style="font-size:14px;margin-bottom:0;">
        <strong style="color:green;font-size:18px;">
          <?php echo $diem; ?>
        </strong>
        <span style="margin-left:8px;">Tuyệt vời - <?php echo $so_danh_gia; ?> đánh giá</span>
      </div>
      <div style="color:#e53935;font-size:20px;font-weight:bold;margin:0;">
        <?php echo number_format($gia, 0, ',', '.'); ?>đ
      </div>
		<?php if ($gia = get_field('gia_tour')): ?>
  <a href="<?= site_url('/thanh-toan?price=' . intval($gia)) ?>" class="tour-request-btn"style="background:#e1703a;color:white;padding:12px 24px;border-radius:8px;text-align:center;max-width:200px;">Thanh toán</a>
<?php endif; ?>
    </div>
  </div>

  <!-- Tabs chuyển mục -->
  <ul style="display:flex;list-style:none;padding:0;margin:24px 0;gap:24px;border-bottom:2px solid #eee;">
    <li><a href="#tien-ich">Tiện ích</a></li>
    <li><a href="#noi-bat">Điểm nổi bật</a></li>
    <li><a href="#noi-dung">Thông tin & Đánh giá</a></li>
  </ul>

  <!-- Tiện ích -->
  <div id="tien-ich">
    <h2>Tiện ích khách sạn</h2>
    <?php if ($tien_ich): ?>
      <div style="columns:3;-webkit-columns:3;-moz-columns:3;max-height:150px;overflow:hidden;" id="list-tien-ich">
        <ul style="padding-left:20px;">
        <?php foreach ($tien_ich as $ti): ?>
          <li><?php echo esc_html($ti); ?></li>
        <?php endforeach; ?>
        </ul>
      </div>
      <button onclick="document.getElementById('list-tien-ich').style.maxHeight='none';this.style.display='none';" style="margin-top:10px;background:none;color:#e1703a;border:none;cursor:pointer;">Xem thêm</button>
    <?php endif; ?>
  </div>

  <!-- Điểm nổi bật -->
  <div id="noi-bat" style="background:#fff5e6;border-left:5px solid #ffc107;padding:16px;margin:24px 0;border-radius:8px;">
    <h2 style="color:#e1703a;margin-top:0;">Điểm nổi bật <?php the_title(); ?></h2>
    <ul style="padding-left:20px;">
      <?php foreach (explode("\n", $noi_bat) as $line): ?>
        <li><?php echo esc_html($line); ?></li>
      <?php endforeach; ?>
    </ul>
  </div>

  <!-- Nội dung bài viết -->
<section class="hotel-rooms-section">
  <div class="hotel-rooms-container">
    <?php if( have_rows('loai_phong') ): ?>
      <?php while( have_rows('loai_phong') ): the_row(); 
        $ten_phong = get_sub_field('ten_phong');
        $anh_phong = get_sub_field('anh_phong');
        $dien_tich = get_sub_field('dien_tich_phong');
        $so_nguoi = get_sub_field('so_nguoi');
        $huong_phong = get_sub_field('huong_phong');
        $so_giuong = get_sub_field('so_giuong');
        $vat = get_sub_field('vat');
        $bua_an = get_sub_field('bua_an');
        $gia = get_sub_field('gia_tour');
      ?>
      <div class="room-card">
        <div class="room-image">
          <?php if ($anh_phong): ?>
            <img src="<?php echo esc_url($anh_phong['url']); ?>" alt="<?php echo esc_attr($ten_phong); ?>">
          <?php endif; ?>
        </div>
        <div class="room-info">
          <h3><?php echo esc_html($ten_phong); ?></h3>
          <div class="room-info-grid">
            <div><strong>Diện tích:</strong> <?php echo esc_html($dien_tich); ?>m²</div>
            <div><strong>Sức chứa:</strong> <?php echo esc_html($so_nguoi); ?></div>
            <div><strong>Hướng:</strong> <?php echo esc_html($huong_phong); ?></div>
            <div><strong>Giường:</strong> <?php echo esc_html($so_giuong); ?></div>
          </div>
          <div class="room-sub-info">
            <div><strong>VAT:</strong> <?php echo esc_html($vat); ?></div>
            <div><strong>Bữa ăn:</strong> <?php echo esc_html($bua_an); ?></div>
          </div>
          <a href="/thanh-toan?price=<?php echo $gia; ?>" class="room-price-box">
            <?php echo number_format($gia, 0, ',', '.'); ?>đ
          </a>
        </div>
      </div>
      <?php endwhile; ?>
    <?php endif; ?>
  </div>
</section>

<style>
.hotel-rooms-section {
  padding: 30px 15px;
  background-color: #f9f9f9;
}
.hotel-rooms-container {
  max-width: 1100px;
  margin: auto;
}
.room-card {
  display: flex;
  gap: 20px;
  margin-bottom: 30px;
  background: #fff;
  border: 1px solid #eee;
  border-radius: 8px;
  overflow: hidden;
  padding: 15px;
  align-items: center;
}
.room-image {
  flex-shrink: 0;
  display: flex;
  justify-content: center;
  align-items: center;
}
.room-image img {
  width: 200px;
  height: auto;
  object-fit: cover;
  border-radius: 6px;
}
.room-info {
  flex: 1;
}
.room-info h3 {
  margin: 0 0 12px;
  color: #222;
  font-size: 20px;
}
.room-info-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 5px 20px;
  margin-bottom: 10px;
  font-size: 14px;
}
.room-sub-info {
  font-size: 14px;
  margin-bottom: 12px;
}
.room-sub-info div {
  margin-bottom: 4px;
}
.room-price-box {
  display: inline-block;
  border: 2px solid #660000;
  color: #660000;
  font-weight: bold;
  font-size: 18px;
  padding: 6px 14px;
  border-radius: 5px;
  text-align: center;
}

/* Responsive mobile */
@media (max-width: 768px) {
  .room-card {
    flex-direction: column;
    text-align: center;
  }
  .room-image img {
    width: 100%;
    max-width: 100%;
  }
  .room-info-grid {
    grid-template-columns: 1fr 1fr;
    text-align: left;
    justify-content: center;
  }
  .room-sub-info {
    text-align: left;
  }
  .room-price-box {
    margin-top: 10px;
  }
}
</style> 
  <div id="noi-dung" style="margin-top:40px;">
    <h2>Thông tin khách sạn</h2>
    <?php the_content(); ?>

<div style="margin-top: 40px;">
      <h2>Đánh giá của Khách hàng</h2>
      <div style="font-size: 18px; font-weight: bold; color: green;">9.2 <span style="color:#444; font-size:14px;">Tuyệt vời - 62 đánh giá</span></div>
      <div style="margin: 12px 0 20px;"><a href="#" style="color:#e1703a;">Điểm chi tiết &raquo;</a></div>

      <?php
      $danh_gia = [
        ['name' => 'Khánh An', 'score' => '9.4', 'content' => 'Dịch vụ ở đây rất tốt, nhân viên thân thiện, không gian sạch sẽ. Mình ấn tượng nhất là buffet sáng.'],
        ['name' => 'Văn Khoa', 'score' => '9.4', 'content' => 'Hồ bơi đẹp và rộng. Phòng ốc hiện đại. Mình sẽ quay lại lần sau.'],
        ['name' => 'Đức Đạt', 'score' => '9.2', 'content' => 'Gia đình mình đã có kỳ nghỉ tuyệt vời. Trẻ em rất thích khu vui chơi ở đây.'],
        ['name' => 'Thảo Lan', 'score' => '9.2', 'content' => 'Nhân viên hỗ trợ nhiệt tình, bữa ăn ngon. Vị trí gần trung tâm nên rất tiện đi lại.'],
        ['name' => 'Minh Huy', 'score' => '9.3', 'content' => 'Cảnh quan đẹp, phòng rộng rãi, view nhìn ra biển cực kỳ chill.'],
        ['name' => 'Ngọc Hà', 'score' => '9.5', 'content' => 'Đi nghỉ dưỡng cùng bạn bè rất vui. Đặc biệt thích không gian nhà hàng và spa.'],
        ['name' => 'Lê Dương', 'score' => '9.1', 'content' => 'Dịch vụ chuyên nghiệp, mình đánh giá cao sự chu đáo của nhân viên.'],
        ['name' => 'Hoàng Tú', 'score' => '9.3', 'content' => 'Bữa sáng đa dạng món, phòng được dọn sạch mỗi ngày.'],
        ['name' => 'Quỳnh Mai', 'score' => '9.0', 'content' => 'Vị trí tiện lợi, gần các điểm tham quan. Giá cả hợp lý.'],
        ['name' => 'Anh Khoa', 'score' => '9.2', 'content' => 'Chất lượng tốt so với tầm giá. Rất đáng để trải nghiệm.'],
      ];

      foreach ($danh_gia as $dg) {
        echo '<div style="border-top:1px solid #eee;padding:16px 0;">';
        echo '<div style="font-weight:bold;color:green;font-size:16px;">' . esc_html($dg['score']) . ' <span style="color:#555;">Tuyệt vời</span> - ' . esc_html($dg['name']) . '</div>';
        echo '<p style="margin: 8px 0;">' . esc_html($dg['content']) . '</p>';
        echo '</div>';
      }
      ?>
    </div>
  </div>
</div>

<?php get_footer(); ?>
